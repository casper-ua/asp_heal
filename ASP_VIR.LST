
 File infectors
 ──────────────
╔═══════════════╤════╤════╤════╤═════╤═══════════╤═════╤══════════════════╗
║      Name     │Inf.│TSR │Eff │ Len │ Infected  │Inf. │File's len growing║
║               │way │    │ects│( L )│   files   │place│                  ║
╠═══════════════╪════╪════╪════╪═════╪═══════════╪═════╪══════════════════╣
║Cascade.1701(2)│INT │MCB │ V  │1701 │   C   *   │  e  │ L                ║
║Cascade.1704   │INT │MCB │ V  │1704 │   C   *   │  e  │ L                ║
║Dir-II      (7)│INT │MCB │ -  │1024 │  .C.E *   │  s  │ 0                ║
║Doodle.2885    │INT │MCB │ S  │2885 │   CE      │  e  │ L+p              ║
║Khizhnjak.469  │FIND│ -  │ -  │469  │  .C&C     │  e  │ L+p              ║
║Phonix.927     │INT │MCB │ HV │927  │  .C.E*    │  e  │ L                ║
║SillyRE.666    │INT │MCB │ H  │666  │  .E&E *   │  e  │ L                ║
║Tune.663       │INT │MCB │ V  │663  │   C  *    │  e  │ L                ║
║Vienna.648     │FIND│ -  │ H  │648  │  .C       │  e  │ L                ║
║XPEH.4928      │INT │ ?  │ H  │4928 │  ?CE      │  e  │ L?               ║
╚═══════════════╧════╧════╧════╧═════╧═══════════╧═════╧══════════════════╝


 The MBR and Boot sector viruses
 ───────────────────────────────

 ╔══════════════════╤════════════╤═══════╤══════════╤══════════╗
 ║      Name        │   Length   │Infect.│Decr. of  │ Envoked  ║
 ║                  │            │objects│memory(K) │ effects  ║
 ╠══════════════════╪════════════╪═══════╪══════════╪══════════╣
 ║AntiEXE        (7)│512  (200h) │   FM  │     1    │    Ch    ║
 ╚══════════════════╧════════════╧═══════╧══════════╧══════════╝

Cascade.1621, 1661 (1,2), 1701 (1,2), 1704, 1706
    Неопасные  резидентные  шифрованные  вирусы. Вызывают эффект "падаю-
    щих букв".
Cascade-1701, -1704
    Два варианта в протоколе можно различать по разности длин. Заражает
    только  COM-программы,  однако  опознает  их  не  по  имени,  а  по
    внутреннему   формату.   Это  широко  известный  вирус,  вызывающий
    осыпание букв на экране.  Как и большинство вирусов,  он остается в
    памяти машины и заражает запускаемые после него программы. Алгоритм
    активизации использует часы и устроен таким образом,  что наблюдать
    деятельность этого вируса (осыпание букв) можно обычно только на PC
    -XT,  да и то необходимо  устанавливать  дату.  На  AT  этот  вирус
    демонстрировал  свои  способности  только  в  третьем квартале 1988
    года.  Приятной особенностью этого, как и большинства действительно
    грамотно   написанных  вирусов,  является  отсутствие  непоправимых
    последствий его деятельности.  Следует отметить,  что автор  вируса
    хотел сделать его не заражающим машины фирмы IBM,  но сделал в этом
    месте   ошибку   (перепутал   сегментный   регистр).   Название   в
    классификации SCAN "Cascade [170X]".

Dir-II (1-7)
    Неопасные (Dir-II (5) - опасен ) резидентные вирусы,  встраивающиеся  в
    цепочку  дисковых  драйверов.  Записывают  свой код в последний кластер
    диска.  Для  файлов  с  расширениями  COM и EXE устанавливают указатели
    первого  кластера  данных на данный последний кластер диска, содержащий
    вирусный  код.  Dir-II  (5)  уменьшает длину файлов с рсширением DBF на
    256 байт и удаляет файлы, начинающиеся на AIDS или ADIN.

Khizhnjak.based - вирусы
    Появление  данных  вирусов  обязано  господину  Хижняку - автору  книги
    "Пишем вирус и антивирус". В данной  книжице  был  опубликован исходный
    текст  тривиального  нерезидентного  вируса,  заражающего  COM-файлы  в
    текущем директории.

Phonix.927
    Опасный  резидентный  вирус.  При  старте  инфицированного  файла вирус
    пытается  заразить  командный  процессор (COMMAND.COM). Инсталируется в
    память  вирус только из командного процессора. Заражает COM и EXE-файлы
    при  их  закрытии  (f.3Eh Int 21h). В пятницу 13 числа вирус уничтожает
    содержимое 14 цилиндров жесткого диска и выводит строку "PhФnix".

SillyRE.666
    Опасный шифрованный вирус. После установки  в  память  своей  TSR-копии
    вирус записывает длинной записью (f.0Bh INT 13h) в 11 сектор 0  дорожки
    1 головки (обычно первая копия FAT) "мусор".

Vienna-648, -534, -574, -623, -625, -627, -23693
     Наиболее  примитивный  из  широко  распространенных  вирусов.   При
     загрузке   в  память  просматривает  все  COM-программы  в  текущем
     каталоге  и  в  доступных  через  PATH.  Первую  найденную  еще  не
     зараженную  программу  либо  заражает,  либо,  с  вероятностью 1/8,
     портит таким образом,  что она при  запуске  вызывает  перезагрузку
     системы.   Если  испорченной  таким  образом  оказывается  одна  из
     программ,  вызываемых из AUTOEXEC.BAT, процедура начальной загрузки
     зацикливается.  Самым  опасным свойством этого вируса оказалась его
     простота.  Из-за этого в  малопочтенное  общество  авторов  вирусов
     смогла вступить группа личностей, способных разобраться в несложной
     чужой программе и слегка ее модифицировать. Таким образом появилось
     много разновидностей этого вируса,  отличающихся от него длинами. В
     модификации  длиной  623 вместо ухода на перезагрузку стоит переход
     по  адресу  C800:0000.  Вероятно,  предполагалось,  что  от   этого
     произойдет  форматизация  диска.  Если  у  Вас будет обнаружен этот
     вирус,  можете сами искать модули,  в начале которых стоит EA 00 00
     00 C8,  и стирать их с диска.  Думаю, что предметом особой гордости
     автора  этой  модификации  была  обработка   ошибок   ввода/вывода,
     благодаря  чему  не должны выдаваться сообщения о попытке записи на
     защищенную дискету.  В версии 627 отключена ветка порчи программ, в
     связи  с  чем  она  занимается  только  размножением.  Версия 23693
     появилась в Ленинграде и является,  вероятно,  самой безграмотной и
     гнусной.   Естественно,  проверка  длины  заражаемой  программы  не
     скорректирована.  Оригинальный  вирус  и,  если  не  ошибаюсь,  все
     модификации   помечают  зараженные  файлы,  проставляя  во  времени
     коррекции файла 62 секунды.  При лечении эта пометка не  снимается.
     Некоторые  антивирусные программы реагируют на эту пометку, заявляя
     о наличии вируса "Time Stamp".

XPEH-4928
     Активизируется независимо  от даты.  Старается  скрывать  удлинение
     зараженных файлов  корректировкой  длин  после  исполнения  функций
     поиска в каталоге. Кроме того, из абсолютно непонятных соображений,
     при загрузке  COMMAND.COM с  параметром "/C DIR ..." самостоятельно
     выдает каталог  на консоль,  причем не  вполне корректно. Например,
     если задать  в качестве  параметра имя подкаталога, будет выдано не
     его содержимое,  а только  он сам.  Начиная с  1992 года  по  дням,
     которые совпадают  с номером  месяца, (1  января, 2 февраля и т.д.)
     собирается стирать  содержимое 1-го  твердого диска,  предваряя это
     сообщением:
        Если у вас есть индикатор работы с жестким диском
         и он горит, то форматизация диска близится к концу
         Большой привет
     Одного мне так и не удалось понять - откуда в людях берется столько
     тупой злобы.

Phx (PHOENIX)
     Серия вирусов одного автора (Болгария).  Почти все заражают  только
     COM,  причем многократно. Резидентные, причем для перехвата функций
     MS DOS используют весьма  оригинальный  прием.  Все  кодируют  свое
     тело,  причем  сама  подпрограмма  раскодировки  случайным  образом
     варьируется во всех версиях, кроме 800. Прочие особенности версий:

Phonix-927
     Заражает COM и EXE,  резидентный.  В "черную  пятницу"  стирает  14
     цилиндров  первого твердого диска и выводит на консоль "PhФnix". Не
     проверяет сигнатуру EXE-файлов.

Khizhnjak
     За вирусы этой группы следует благодарить автора книги "Пишем вирус
     и  антивирус"  Хижняка.  В  ней  был   опубликован   с   подробными
     комментариями   исходный   текст   абсолютно  примитивного  вируса,
     заражающего COM-файлы в текущем каталоге.  О  таком  подарке  могли
     только мечтать серости с атрофированной порядочностью.  Ниже описан
     личный вклад этой публики.

Khizhnjak-415, -444, -469, -507, -701, -709
     Без особенностей.

FAT-666
     Заражает только EXE,  резидентный. Первым делом старается испортить
     на первом твердом диске сектор 11 дорожки  1,  который  чаще  всего
     принадлежит первой копии FAT.  Для специалиста исправление этого не
     должно  составить  трудности.  Не  заражает  файлы,   имя   которых
     начинается на "A".

     системе их нужно переименовать. В конце видно "Novosibirsk".

Tune-663
     Заражает только  COM,  резидентный.  После  запуска   33   программ
     сдвигает изображение на экране вниз и влево.

ANTI_EXE
     Прячет MBR на твердом диске в секторе 13, а на гибком - в последнем
     секторе Root  Directory. При  чтении с диска какой-то EXE-программы
     (у меня ее нет), имеющей длину 200256, портит в буфере 9-й байт.


                       3. О "музыкальной" группе

     В эту группу  входит  довольно  большое  количество  вирусов,  явно
сочиненных одним  автором. Их  общим признаком  является наличие за 4 от
конца байтов с шестнадцатиричным значением F47A. Следующий байт (в файле
он предпоследний)  содержит номер  версии вируса.  Пока в нашу коллекцию
попали следующие версии (номера - шестнадцатиричные, в скобках - длины):

    04 (1212), 05 (1206), 06 (1269), 10 (1339), 17 (1753), 18 (1760), 19
    (1805), 21 (2680), 22 (2568), 26 (2756), 27 (2772), 29 (2932), 2A
    (2997), 2C (2885), 2D (2901), 2E (2981), 53 (1905).

     Ранние версии  AIDSTEST обозначали  представителей  этого семейства
буквами D,  F, G,  H, отмечая  развитие  способов  заражения  и  внешних
проявлений.  Теперь  они  все  обозначаются  буквой  (M)  с  добавлением
шестнадцатиричного номера.  Общей для  всех версий  является способность
заражать как COM, так и EXE-программы.

     В  антивирусных   публикациях   уже   отмечалось,   что   последние
представители этой  компании (начиная  с 29)  модифицируют  "Мячик".  По
моему впечатлению  из этого  не следует,  что и  он принадлежит  тому же
автору.

     Ниже описано все, что удалось выяснить о развитии версий из анализа
известных с некоторой долей интерполяции.

До версии 6 при заражении портится дата создания файла.

До 9  включительно при  заражении COM  требуется, чтобы  первой командой
     была JMP (код E9).

До 10  заражение EXE-программ  происходит в  два  приема  -  при  первом
     программа формально  приводится к  формату COM  и к ней добавляется
     фрагмент длиной 132 байта, который обеспечивает преобразование EXE-
     программы в  памяти для  ее  правильной  работы,  а  при  втором  -
     получившийся агрегат  заражается как  обычный  COM.  Если  AIDSTEST
     встречает такой агрегат, он помечает его как (ML).

Следующие версии, включая 22, также преобразуют EXE в COM, однако делают
     это в  один прием.  Пока не  известно, где  проходит граница  между
     версиями 10 и 17.

Начиная с версии 23, EXE программы сохраняют свой формат, причем во всех
     заражаемых модулях  со смещением 0x12 от начала стоит расстояние до
     начала  вируса,  деленное  на  16.  Одновременно  в  начале  вируса
     дублируется пароль  F47A  и  номер  версии.  Версии  2D  и  2E  при
     заражении EXE в конец файла эту информацию не пишут.

С версии  17 размножение  не обнаруживается  резидентными  антивирусными
     программами, следящими  за записью  в программные  файлы, поскольку
     вирус  передает   управление  непосредственно   в  MS DOS,   обходя
     сторожей.

С версии  21 вирусы  принимают очень  хитрые меры защиты от вирусологов.
     Вирус  оказывается   "невидимым"  при   попытке  пройти  через  его
     резидентную часть  отладчиком  в  пошаговом  режиме  или  поставить
     внутри останов  (Break point). Кроме того, при попытке изучить явно
     зараженную  программу  при  помощи  DEBUG,  она  вдруг  оказывается
     здоровой, конечно, если вирус уже находится в памяти.

     В пользу автора этих  вирусов следует  сказать, что  никакие подлые
шутки в  них не  предусмотрены. Более  того, принимаются все меры, чтобы
зараженные программы  всегда работали  правильно. Даже попытка умышленно
заразить программу  для коллекции не всегда кончается успехом. До версии
10 не  удалось обнаружить  вообще никаких  шуток, а  остальные исполняют
мелодию,  которую   знатоки  идентифицируют  как  "Янки  Дудль"  (Yankee
Doodle). Версии  17-19 исполняют ее перед перезагрузкой по CTRL+ALT+DEL,
a следующие - в 17 часов (точнее в 16:59:53).

     Остается выразить   сожаление,  что  явно  талантливый  программист
потратил столько  сил и изобретательности на такую неблагодарную работу,
которая даже для саморекламы не очень годится.

     Обнаруженная в конце 1990  года  версия  53  является  плагиатом  с
последних версий, причем без наиболее тонких возможностей.


                             4. Вирус "DIR"

     Этот  вирус  начинает   принципиально   новую  группу  компьютерных
вирусов.  Внешне он проявляется весьма странно. Дискета, зараженная этим
вирусом,   кажется   безнадежно  испорченной.  Программа  CHKDSK  выдает
сообщения о многочисленных пересечениях файлов  ("...  cross  linked  on
cluster ...") и цепочках потерянных кластеров ("...  lost clusters found
in ...  chains.").  При попытке скопировать с такой дискеты  программные
файлы из них копируется только 1024 байта,  хотя в каталоге стоят совсем
другие длины.  Однако, стоит только исполнить одну из этих программ, как
дискета сама по себе исправляется.

     Основная идея  вируса заключается в том,  что его тело находится на
диске в одном месте.  Обычно это последний кластер  диска,  который  при
этом  помечается  в FAT как "конец файла".  Одновременно в каталогах для
всех COM- и EXE-файлов ссылка на начало файла меняется на этот  кластер,
а  правильный  указатель  в  закодированном  виде  прячется  в резервной
области строки каталога.  Таким образом,  при запуске любой программы  в
память  загружается  вирус.  После  этого вирус подключается к дисковому
драйверу и при всех нормальных обращениях к каталогу  отдает  правильные
ссылки.

     К сожалению,  в  вирусе  имеются  ошибки.  Во-первых тело вируса не
всегда записывается на диск, хотя ссылки и указывают на то место, где он
должен быть.  Кроме того,  вирус иногда неправильно определяет параметры
диска и образуются два потенциальных места размещения вируса. Если такая
ситуация происходит на диске "C:", система перестает загружаться.

     Почти безнадежно  испорченым  диск  оказывается  в случае,  если до
лечения его обработали программой CHKDSK с  параметром  /F  (естественно
при загрузке со здоровой системы).

DIR_2
     В связи с  появлением  этой  версии  вируса  алгоритм  лечения  был
     переработан.  Теперь  существенно  повышена  вероятность  успешного
     лечения.  Если диск испорчен вирусом, но AIDSTEST вирус на диске не
     обнаруживает, можно попытаться использовать ключ "/S".

DIR_3
     Отличается от предыдущих очень мало.

DIR_D
     Явно местного  производства  -  при  каждом  обнаружении  в секторе
     каталога расширения ".DBF" вычитает 1 из второго байта  длины,  что
     уменьшает длину файла на 256,  причем на проход через нуль внимание
     не  обращается.  Теоретически  после  лечения  такие  файлы   можно
     исправить,  но  готовых подходящих программ я не знаю.  Кроме того,
     вирус стирает с диска все файлы с именами,  начанающимися на "AIDS"
     и "ADIN".

DIR_4
     Имеет длину кода  больше  1024,  в  связи  с  чем  занимает  четыре
     сектора.  Не заражает диски,  имеющие кластеры из одного сектора (в
     частности,  дискеты 1.2 Мб),  а  также  с  недоступными  последними
     кластерами.  Может  исполнять  мелодию  Паганини  аналогично вирусу
     Tumen, но для этого в момент прерывания от часов во всех регистрах:
     AX,  BX,  CX,  DX,  BP,  SI,  DI  должно  быть одинаковое ненулевое
     значение. Такую ситуацию можно вызвать только искуственно.

DIR_5, DIR_6, DIR_7
     Переделки первой версии,  в  результате  которых  добавлены  мелкие
     ошибки. DIR_5 содержит текст "For pirates....".

DIR_8, DIR_9, DIR_10, DIR_11
     Еще одна  группа  переделок  первой версии.  Похоже,  что из одного
     источника.  Два из них - 9 и 10 - кодируют  себя.  DIR_10  имеет  в
     конце жуткую надпись "CREEPING DEATH 3".

DIR_EXE
     Вполне оригинальная  разработка.  Повторена  только  основная  идея
     способа заражения.  Тело вируса,  имеющее формат  EXE,  помещает  в
     "Cluster 1",  т.е.  в конец Root Directory. Такой подход спасает от
     заражения дискеты 1.2 и  1.4,  поскольку  у  них  в  кластере  один
     сектор.  В  качестве  компенсации  заражает все диски,  в том числе
     размеченные DM  и  ADM.  Побочным  эффектом  является  блокирование
     ошибок  от всех драйверов устройств.  Например,  исполнение команды
     "COPY ......  prn" при выключенном устройстве печати  проходит  без
     каких бы то ни было сообщений об ошибке.

DIR_X
     Какой-то подлец заменил в первой версии пять команд.

DIR_XX-1024
     Очередная переделка начального варианта.

DIR_DX
     Переделка вируса  DIR_D  (скорее  всего не авторская).  На этот раз
     портится длина и у файлов  с  расширениями  ".ZIP"  и  ".AR?".  При
     лечении от этого вируса приходится обнулять время создания файла.

DIR_Hnd-2048
     Образует на  всех  зараженных  дисках  файл CHKLIST.MS.  Есть текст
     "The-Hnd" и "<by:Wai-Chan,Aug94,UCV>".  С 1996 года планирует раз в
     месяц в начале каждого четвертого часа выводить под музыку в первой
     строке экрана текст "TRABAJEMOS TODOS POR VENEZUELLA !!!".

DIR_Hippie-1024
     Еще одна  переделка.  За  счет выброшенных тонких мест освободилось
     место под тексты: "По Интегралу плывет пирога, в ней едут хиппи, их
     очень много.", "БОИНГ-748", "ПО-2", "ТУ144".

DIR_Oct-1024
     Очередная переделка.  В конце текст "Не забудь  поздравить  себя  с
     днём рождения 20 октября.".

ПРИМЕЧАНИЯ:

     Обнаружена  способность   большинства   разновидностей   вируса   к
     двукратному заражению (по крайней мере на дискетах). Это происходит
     при попеременной  работе с  дискетами  разных  типов.  После  этого
     успешное лечение становится невозможным.

     Как упоминалось  выше,  довольно  часто  на  испорченном  диске  не
     оказывается тела  вируса. Лечение в этом случае возможно при помощи
     специальной процедуры  проверки, которая  включается заданием ключа
     "/S". При  этом в  протоколе различаются  следующие  разновидности:
     DIR, DIR_D, DIR_EXE, DIR_DX, DIR_6.
